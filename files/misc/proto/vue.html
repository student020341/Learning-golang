<style>
    
    .project-list {
        list-style: none;
        margin: 0;
        padding: 0;
    }

    .project-list li {
        cursor: pointer;
        display: inline-block;
        margin-right: 8px;
        font-size: 0;
    }

    .project-list li > span {
        font-size: 16px;
    }

    .project-list li .new {
        border: 1px solid green;
        padding: 4px;
    }

    .project-list li .new a {
        color: black;
        text-decoration: none;
    }

    .project-list li .delete {
        background: red;
        color: white;
        padding: 4px;
        border: 1px solid red;
    }

    .project-list li .name {
        padding: 4px 8px;
        border: 1px solid black;
        border-left: none;
    }

</style>

<script src="/misc/file/proto/vue.js"></script>
<script src="/misc/file/proto/vue-router.js"></script>

<div id="app">
    <template v-if="loading">
        <p>some stuff is loading</p>
    </template>
    <template v-else>
        <router-view></router-view>
    </template>
</div>

<script>

    // // templates
    // const templates = {
    //     project: { template: "<div>Project: {{id}}</div>", props: ["id"] },
    //     home: { template: "<div>something</div>" },
    //     notFound: { template: "<div>404 or something</div>" }
    // };

    // // routes
    // const routes = [
    //     { path: "/project/:id", component: templates.project, props: true },
    //     { path: "*", component: templates.notFound }
    // ];

    // router
    const router = new VueRouter();

    // app
    const app = new Vue({
        router,
        data: {
            loading: true,
        }
    }).$mount("#app");

    // fetch templates
    (async () => {
        
        let projects = [{id: 1, name: "test"}];
        const getTemplate = file => fetch(`/misc/file/proto/templates/${file}`).then(response => response.text());

        const components = {
            home: {
                path: "/",
                template: await getTemplate("project-list.html"),
                data: () => ({ projects: [] }), 
                created: async function() {
                    // console.log("home page created event");
                    this.projects = projects;
                }
            },
            newProject: {
                path: "/new-project",
                template: await getTemplate("new-project.html"),
                data: () => ({ name: "" }),
                methods: {
                    goToHome: () => app.$router.push("/"),
                    submit: function () { // needed for "this"
                        projects.push({ id: 2, name: this.name });
                        this.$router.push("/");
                    }
                },
            }
        };

        const routes = Object.values(components).map(component => ({
            path: component.path,
            component
        }));

        app.$router.addRoutes(routes);
        
        app.loading = false;
    })();

</script>